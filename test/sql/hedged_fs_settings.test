# name: test/sql/hedged_fs_settings.test
# description: test hedged filesystem settings
# group: [sql]

require hedged_request_fs

# Test getting default settings
query IT
SELECT name, value FROM duckdb_settings() WHERE name LIKE 'hedged_fs_%' ORDER BY name;
----
hedged_fs_directory_exists_delay_ms	3000
hedged_fs_file_exists_delay_ms	3000
hedged_fs_get_file_size_delay_ms	3000
hedged_fs_get_file_type_delay_ms	3000
hedged_fs_get_last_modified_time_delay_ms	3000
hedged_fs_get_version_tag_delay_ms	3000
hedged_fs_glob_delay_ms	5000
hedged_fs_list_files_delay_ms	5000
hedged_fs_max_hedged_request_count	3
hedged_fs_open_file_delay_ms	3000

# Test updating a setting
statement ok
SET hedged_fs_open_file_delay_ms = 1000;

# Verify the setting was updated
query IT
SELECT name, value FROM duckdb_settings() WHERE name = 'hedged_fs_open_file_delay_ms';
----
hedged_fs_open_file_delay_ms	1000

# Test updating multiple settings
statement ok
SET hedged_fs_glob_delay_ms = 2000;

statement ok
SET hedged_fs_file_exists_delay_ms = 500;

# Verify all updated settings
query IT
SELECT name, value FROM duckdb_settings() WHERE name IN ('hedged_fs_open_file_delay_ms', 'hedged_fs_glob_delay_ms', 'hedged_fs_file_exists_delay_ms') ORDER BY name;
----
hedged_fs_file_exists_delay_ms	500
hedged_fs_glob_delay_ms	2000
hedged_fs_open_file_delay_ms	1000

# Test resetting a setting
statement ok
RESET hedged_fs_open_file_delay_ms;

# Verify the setting was reset to default
query IT
SELECT name, value FROM duckdb_settings() WHERE name = 'hedged_fs_open_file_delay_ms';
----
hedged_fs_open_file_delay_ms	3000
